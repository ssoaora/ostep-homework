
# 개요

이 프로그램 lottery.py는 로터리 스케줄러가 어떻게 작동하는지 보여줍니다. 항상 그렇듯이 프로그램을 실행하는 두 가지 단계가 있습니다. 먼저 -c 플래그 없이 실행하십시오: 이는 답을 공개하지 않고 해결할 문제를 보여줍니다.

```sh
prompt> ./lottery.py -j 2 -s 0
...
여기 각 작업의 실행 시간이 포함된 작업 목록이 있습니다:
  작업 0 ( 길이 = 8, 티켓 = 75 )
  작업 1 ( 길이 = 4, 티켓 = 25 )

여기 필요한 최대 랜덤 숫자 세트가 있습니다:
랜덤 511275
랜덤 404934
랜덤 783799
랜덤 303313
랜덤 476597
랜덤 583382
랜덤 908113
랜덤 504687
랜덤 281838
랜덤 755804
랜덤 618369
랜덤 250506
```

이 방식으로 시뮬레이터를 실행하면 먼저 일부 랜덤 작업을 할당합니다 (여기서는 길이 8과 4), 각각 일정 수의 티켓을 가지고 있습니다 (여기서는 각각 75와 25). 시뮬레이터는 또한 로터리 스케줄러가 무엇을 할지 결정하는 데 필요한 랜덤 숫자 목록을 제공합니다. 랜덤 숫자는 0과 큰 숫자 사이에서 선택되므로, 모듈로 연산자를 사용하여 로터리 승자를 계산해야 합니다 (즉, 승자는 이 랜덤 숫자를 시스템의 총 티켓 수로 나눈 나머지와 같아야 합니다).

-c 플래그와 함께 실행하면 정확히 계산해야 할 내용을 보여줍니다:

```sh
prompt> ./lottery.py -j 2 -s 0 -c
...
** 솔루션 **
랜덤 511275 -> 승리 티켓 75 (100 중) -> 작업 1 실행
  작업들:  (  작업:0 남은시간:8 티켓:75 ) (* 작업:1 남은시간:4 티켓:25 )
랜덤 404934 -> 승리 티켓 34 (100 중) -> 작업 0 실행
  작업들:  (* 작업:0 남은시간:8 티켓:75 ) (  작업:1 남은시간:3 티켓:25 )
랜덤 783799 -> 승리 티켓 99 (100 중) -> 작업 1 실행
  작업들:  (  작업:0 남은시간:7 티켓:75 ) (* 작업:1 남은시간:3 티켓:25 )
랜덤 303313 -> 승리 티켓 13 (100 중) -> 작업 0 실행
  작업들:  (* 작업:0 남은시간:7 티켓:75 ) (  작업:1 남은시간:2 티켓:25 )
랜덤 476597 -> 승리 티켓 97 (100 중) -> 작업 1 실행
  작업들:  (  작업:0 남은시간:6 티켓:75 ) (* 작업:1 남은시간:2 티켓:25 )
랜덤 583382 -> 승리 티켓 82 (100 중) -> 작업 1 실행
  작업들:  (  작업:0 남은시간:6 티켓:75 ) (* 작업:1 남은시간:1 티켓:25 )
--> 작업 1 완료 시간 6
랜덤 908113 -> 승리 티켓 13 (75 중) -> 작업 0 실행
  작업들:  (* 작업:0 남은시간:6 티켓:75 ) (  작업:1 남은시간:0 티켓:--- )
랜덤 504687 -> 승리 티켓 12 (75 중) -> 작업 0 실행
  작업들:  (* 작업:0 남은시간:5 티켓:75 ) (  작업:1 남은시간:0 티켓:--- )
랜덤 281838 -> 승리 티켓 63 (75 중) -> 작업 0 실행
  작업들:  (* 작업:0 남은시간:4 티켓:75 ) (  작업:1 남은시간:0 티켓:--- )
랜덤 755804 -> 승리 티켓 29 (75 중) -> 작업 0 실행
  작업들:  (* 작업:0 남은시간:3 티켓:75 ) (  작업:1 남은시간:0 티켓:--- )
랜덤 618369 -> 승리 티켓 69 (75 중) -> 작업 0 실행
  작업들:  (* 작업:0 남은시간:2 티켓:75 ) (  작업:1 남은시간:0 티켓:--- )
랜덤 250506 -> 승리 티켓 6 (75 중) -> 작업 0 실행
  작업들:  (* 작업:0 남은시간:1 티켓:75 ) (  작업:1 남은시간:0 티켓:--- )
--> 작업 0 완료 시간 12
```

이 추적에서 볼 수 있듯이, 해야 할 일은 랜덤 숫자를 사용하여 어떤 티켓이 승자인지 알아내는 것입니다. 그런 다음, 승리 티켓을 기준으로 어떤 작업이 실행되어야 하는지 알아냅니다. 모든 작업이 완료될 때까지 이를 반복합니다. 이게 전부입니다 -- 로터리 스케줄러가 하는 일을 수작업으로 에뮬레이트하는 것입니다!

이 예제에서 첫 번째 결정을 명확히 하기 위해 다시 보겠습니다. 이 시점에서 우리는 두 개의 작업이 있습니다 (작업 0은 실행 시간이 8이고 티켓이 75개, 작업 1은 실행 시간이 4이고 티켓이 25개). 주어진 첫 번째 랜덤 숫자는 511275입니다. 시스템에 100개의 티켓이 있으므로, 511275 % 100은 75이고, 따라서 75가 승리 티켓입니다.

티켓 75가 승리 티켓이라면, 작업 목록을 검색하여 찾기만 하면 됩니다. 첫 번째 항목인 작업 0은 75개의 티켓을 가지고 있으므로 (0에서 74까지), 승리하지 않습니다; 다음 항목은 작업 1이며, 따라서 승리자를 찾았으므로 이 예제에서 퀀텀 길이 (1) 동안 작업 1을 실행합니다. 모든 것이 다음과 같이 출력됩니다:

```sh
랜덤 511275 -> 승리 티켓 75 (100 중) -> 작업 1 실행
  작업들:  (  작업:0 남은시간:8 티켓:75 ) (* 작업:1 남은시간:4 티켓:25 )
```

보시다시피, 첫 번째 줄은 무슨 일이 일어났는지 요약하고, 두 번째 줄은 전체 작업 큐를 보여주며, *는 선택된 작업을 나타냅니다.

시뮬레이터에는 몇 가지 다른 옵션이 있으며, 대부분은 자명합니다. 특히, -l/--jlist 플래그는 항상 랜덤하게 생성된 작업 목록을 사용하는 대신 작업과 티켓 값을 정확하게 지정하는 데 사용할 수 있습니다.

```sh
prompt> ./lottery.py -h
사용법: lottery.py [옵션]

옵션:
  -h, --help            
      이 도움말 메시지를 표시하고 종료합니다
  -s SEED, --seed=SEED  
      랜덤 시드
  -j JOBS, --jobs=JOBS  
      시스템의 작업 수
  -l JLIST, --jlist=JLIST
      랜덤 작업 대신 실행 시간과 티켓 값을 쉼표로 구분된 목록으로 제공 (예: 10:100,20:100은 실행 시간이 10과 20이고 각각 100개의 티켓을 가진 두 개의 작업을 가짐)
  -m MAXLEN, --maxlen=MAXLEN
      작업의 최대 길이
  -T MAXTICKET, --maxtick=MAXTICKET
      랜덤하게 할당된 경우 최대 티켓 값
  -q QUANTUM, --quantum=QUANTUM
      시간 슬라이스 길이
  -c, --compute
      답을 계산해줍니다
```
